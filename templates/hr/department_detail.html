{% extends "base.html" %}
{% load static %}

{% block title %}
Department · {{ object.complete_name|default:object.name }}
{% endblock %}

{% block content %}

<div class="max-w-7xl mx-auto space-y-6">

  <!-- ========================= -->
  <!-- Header -->
  <!-- ========================= -->
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-semibold">
        {{ object.complete_name|default:object.name }}
      </h1>
      <p class="text-sm opacity-70">
        Department details
      </p>
    </div>

    <div class="flex gap-2">
      {% if can_change %}
        <a href="{% url 'hr:department_edit' object.pk %}"
           class="btn btn-sm btn-primary">
          Edit
        </a>
      {% endif %}

      <a href="{% url 'hr:department_list' %}"
         class="btn btn-sm btn-ghost">
        Back
      </a>
    </div>
  </div>

  <!-- ========================= -->
  <!-- Core Info -->
  <!-- ========================= -->
  <div class="card">
    <div class="card-body grid grid-cols-1 md:grid-cols-2 gap-6">

      <div>
        <div class="text-sm opacity-60">Name</div>
        <div class="font-medium">{{ object.name }}</div>
      </div>

      <div>
        <div class="text-sm opacity-60">Company</div>
        <div class="font-medium">{{ object.company }}</div>
      </div>

      <div>
        <div class="text-sm opacity-60">Parent Department</div>
        <div class="font-medium">
          {% if object.parent %}
            <a href="{% url 'hr:department_detail' object.parent.pk %}"
               class="link link-hover">
              {{ object.parent.name }}
            </a>
          {% else %}
            —
          {% endif %}
        </div>
      </div>

      <div>
        <div class="text-sm opacity-60">Manager</div>
        <div class="font-medium">
          {% if object.manager %}
            {{ object.manager }}
          {% else %}
            —
          {% endif %}
        </div>
      </div>

      <div>
        <div class="text-sm opacity-60">Status</div>
        <div>
          {% if object.active %}
            <span class="badge badge-success badge-sm">Active</span>
          {% else %}
            <span class="badge badge-ghost badge-sm">Archived</span>
          {% endif %}
        </div>
      </div>

      <div>
        <div class="text-sm opacity-60">Level</div>
        <div class="font-medium capitalize">
          {{ object.level }}
        </div>
      </div>

      {% if object.note %}
        <div class="md:col-span-2">
          <div class="text-sm opacity-60">Note</div>
          <div class="mt-1 whitespace-pre-line">
            {{ object.note }}
          </div>
        </div>
      {% endif %}

    </div>
  </div>

  <!-- ========================= -->
  <!-- Child Departments -->
  <!-- ========================= -->
  <div class="card">
    <div class="card-body">

      <h2 class="font-semibold mb-4">
        Sub-departments
      </h2>

      {% if children %}
        <ul class="list-disc list-inside space-y-1">
          {% for dept in children %}
            <li>
              <a href="{% url 'hr:department_detail' dept.pk %}"
                 class="link link-hover">
                {{ dept.name }}
              </a>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="opacity-60 text-sm">
          No sub-departments.
        </p>
      {% endif %}

    </div>
  </div>

  <!-- ========================= -->
  <!-- Employees -->
  <!-- ========================= -->
  <div class="card">
    <div class="card-body">

      <h2 class="font-semibold mb-4">
        Employees in this department
      </h2>

      {% if employees %}
        <table class="table table-zebra w-full">
          <thead>
            <tr>
              <th>Name</th>
              <th>Job</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for emp in employees %}
              <tr>
                <td>{{ emp.name }}</td>
                <td>{{ emp.job|default:"—" }}</td>
                <td>
                  {% if emp.active %}
                    <span class="badge badge-success badge-sm">Active</span>
                  {% else %}
                    <span class="badge badge-ghost badge-sm">Archived</span>
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p class="opacity-60 text-sm">
          No employees assigned.
        </p>
      {% endif %}

    </div>
  </div>

</div>

{% endblock %}
