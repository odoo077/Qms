<li class="relative pl-6 border-l border-base-300">
  <details class="group open:animate-fadeInDown my-1">
    <summary class="flex items-center gap-2 cursor-pointer py-1">

      <!-- Arrow Icon -->
      <svg class="w-4 h-4 text-base-content transition-transform duration-200 group-open:rotate-90" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
      </svg>

      <!-- Icon per level (Dept, Section, Team) -->
      {% with node.complete_name|default:node.name as name %}
        {% if "Team" in name %}
          <span class="text-xs text-info">ğŸ‘¥</span>
        {% elif "Section" in name %}
          <span class="text-xs text-warning">ğŸ·ï¸</span>
        {% else %}
          <span class="text-xs text-success">ğŸ¢</span>
        {% endif %}
      {% endwith %}

      <!-- Department Name -->
      <a href="{% url 'hr:department_detail' node.pk %}" class="font-medium hover:text-primary">
        {{ node.complete_name|default:node.name }}
      </a>

      <!-- Edit Badge -->
      {% if node.id in dept_change_ids %}
        <span class="badge badge-success badge-sm">Can Edit</span>
      {% endif %}

      <!-- Manager Badge -->
      {% if node.manager %}
        <span class="badge badge-outline badge-sm">{{ node.manager.name }}</span>
      {% endif %}
    </summary>

    {% if node.children.all %}
      <ul class="ml-3 mt-1 space-y-1 border-l border-dashed border-base-200">
        {% for child in node.children.all %}
          {% include "hr/includes/department_tree_node.html" with node=child dept_change_ids=dept_change_ids %}
        {% endfor %}
      </ul>
    {% endif %}
  </details>
</li>
