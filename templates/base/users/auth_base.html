{% load static %}
<!doctype html>
<html lang="en" dir="ltr" class="no-transitions" data-theme="{{ request.COOKIES.theme|default:'corporate' }}">
<head>
  <meta charset="utf-8" />
  <title>{% block title %}Authentication{% endblock %} · 360 Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="{% static 'css/dist/styles.css' %}" rel="stylesheet" />
  <link rel="icon" href="{% static 'images/favicon.ico' %}" />
  <style>
    .no-transitions *, .no-transitions *::before, .no-transitions *::after {
      transition: none !important;
      animation: none !important;
    }
  </style>
  {% block head_extra %}{% endblock %}
</head>

<body class="min-h-screen bg-base-100 text-base-content">

  <!-- Top bar شفاف فوق الخلفية -->
  <header class="fixed inset-x-0 top-0 z-40">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 flex items-center justify-between">
      <!-- Logo → يرجع للصفحة الرئيسية -->
      <a href="{% url 'base:home' %}" class="inline-flex items-center gap-1.5 text-sm font-semibold tracking-tight">
        <span class="px-2 py-1 rounded-full bg-base-100/80 shadow-sm border border-base-200/60">
          <span class="text-primary font-black">360</span>
          <span class="font-semibold">Manager</span>
        </span>
      </a>

      <div class="flex items-center gap-2">
        {% block header_actions %}{% endblock %}

        <!-- Theme toggle -->
        <button id="theme-toggle"
                class="btn btn-ghost btn-sm rounded-full border border-base-300/70 bg-base-100/70 shadow-sm hover:border-primary/50"
                type="button" aria-label="Toggle theme">
          <svg id="icon-moon" xmlns="http://www.w3.org/2000/svg" class="size-4" viewBox="0 0 24 24" fill="currentColor">
            <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
          </svg>
          <svg id="icon-sun" xmlns="http://www.w3.org/2000/svg" class="size-4 hidden" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 5a1 1 0 001-1V2h-2v2a1 1 0 001 1zm0 14a1 1 0 00-1 1v2h2v-2a1 1 0 00-1-1z" />
            <path d="M4.22 5.64L5.64 4.22 7.05 5.64 5.64 7.05zM16.95 18.36l1.41 1.41 1.42-1.41-1.41-1.42z" />
            <path d="M2 11h2v2H2zM20 11h2v2h-2z" />
            <path d="M5.64 16.95l1.41 1.41 1.42-1.42-1.41-1.41zM18.36 7.05l1.41-1.41-1.41-1.41-1.42 1.42z" />
            <circle cx="12" cy="12" r="5" />
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Main animated scene -->
  <main class="relative flex min-h-screen items-center justify-center overflow-hidden px-4 py-20 sm:px-6 lg:px-8">

    <!-- Gradient background -->
    <div aria-hidden="true" class="pointer-events-none absolute inset-0 -z-20 bg-gradient-to-br from-primary/10 via-base-100 to-base-100"></div>

    <!-- Floating blobs (أقرب لفكرة antigravity ولكن هادئة) -->
    <div aria-hidden="true"
         class="pointer-events-none absolute -left-32 top-10 h-72 w-72 rounded-full bg-primary/40 blur-[110px] opacity-70 animate-orbit-slow"></div>
    <div aria-hidden="true"
         class="pointer-events-none absolute right-[-8rem] top-40 h-80 w-80 rounded-full bg-secondary/40 blur-[120px] opacity-60 animate-orbit-medium"></div>
    <div aria-hidden="true"
         class="pointer-events-none absolute inset-x-20 bottom-[-6rem] h-64 rounded-[999px] bg-accent/40 blur-[100px] opacity-50 animate-orbit-fast"></div>

    <!-- Main auth container -->
    <div class="relative z-10 max-w-6xl w-full">
      <div class="glass-surface grid gap-10 p-6 sm:p-8 lg:p-10 lg:grid-cols-[minmax(0,1.1fr)_minmax(0,1fr)] items-center">

        <!-- Left: HR context + mini stats -->
        <section class="space-y-6">
          <div class="inline-flex items-center gap-2 rounded-full bg-base-100/80 px-3 py-1 text-xs font-medium border border-base-200/70">
            <span class="badge badge-success badge-xs"></span>
            <span>Employee & HR management platform</span>
          </div>

          <div class="space-y-3">
            <h1 class="text-3xl sm:text-4xl font-black tracking-tight leading-tight">
              A modern control center<br class="hidden sm:block" />
              for your organization.
            </h1>
            <p class="text-sm sm:text-base text-base-content/70 leading-relaxed">
              360 Manager centralizes employees, departments, companies, skills, assets,
              performance evaluations and payroll into one secure workspace, inspired by
              enterprise systems like Odoo.
            </p>
          </div>

          <dl class="grid grid-cols-1 sm:grid-cols-3 gap-3 text-xs sm:text-sm">
            <div class="rounded-2xl bg-base-100/80 border border-base-200/70 px-4 py-3">
              <dt class="text-base-content/60">Employees</dt>
              <dd class="mt-1 font-semibold">People & HR records</dd>
            </div>
            <div class="rounded-2xl bg-base-100/80 border border-base-200/70 px-4 py-3">
              <dt class="text-base-content/60">Assets & skills</dt>
              <dd class="mt-1 font-semibold">Equipment & competencies</dd>
            </div>
            <div class="rounded-2xl bg-base-100/80 border border-base-200/70 px-4 py-3">
              <dt class="text-base-content/60">Performance</dt>
              <dd class="mt-1 font-semibold">Reviews & payroll cycles</dd>
            </div>
          </dl>
        </section>

        <!-- Right: Auth card (login / register / reset) -->
        <section class="space-y-6">
          {% if messages %}
            <div class="space-y-2 mb-1">
              {% for message in messages %}
                <div class="alert alert-{{ message.tags|default:'info' }} text-xs sm:text-sm">
                  <span>{{ message }}</span>
                </div>
              {% endfor %}
            </div>
          {% endif %}

          <div class="bg-base-100/90 border border-base-200/70 rounded-2xl shadow-lg px-5 py-6 sm:px-6 sm:py-7">
            <div class="flex items-start justify-between gap-3 mb-4">
              <div>
                <h2 class="text-xl sm:text-2xl font-bold tracking-tight">
                  {% block page_title %}{% endblock %}
                </h2>
                <p class="mt-1 text-xs sm:text-sm text-base-content/70">
                  {% block page_subtitle %}{% endblock %}
                </p>
              </div>
              <div class="shrink-0">
                {% block card_action %}{% endblock %}
              </div>
            </div>

            <div class="divider my-4"></div>

            {% block content %}{% endblock %}
            {% block below_form %}{% endblock %}
          </div>

          <p class="text-[10px] sm:text-xs text-base-content/60 text-center">
            © {% now "Y" %} 360 Manager · Employee Management System
          </p>
        </section>
      </div>
    </div>
  </main>

  <!-- Theme switcher script -->
  <script>
    (function () {
      const html = document.documentElement;
      const btn  = document.getElementById("theme-toggle");
      const sun  = document.getElementById("icon-sun");
      const moon = document.getElementById("icon-moon");
      const DARK = new Set(["business","dark","black"]);

      function getCookie(name){
        const m = document.cookie.match(new RegExp('(?:^|; )' + name + '=([^;]+)'));
        return m ? decodeURIComponent(m[1]) : null;
      }
      function setCookie(name,value,days){
        const max = days ? `; max-age=${days*86400}` : "";
        document.cookie = `${name}=${encodeURIComponent(value)}; path=/${max}`;
      }
      function setTheme(t){
        html.setAttribute("data-theme", t);
        localStorage.setItem("theme", t);
        setCookie("theme", t, 365);
        const isDark = DARK.has(t);
        sun.classList.toggle("hidden", !isDark);
        moon.classList.toggle("hidden", isDark);
      }

      const initial = getCookie("theme") || localStorage.getItem("theme") || html.getAttribute("data-theme") || "corporate";
      setTheme(initial);

      btn?.addEventListener("click", () => {
        const current = html.getAttribute("data-theme") || "corporate";
        const next = (current === "corporate") ? "business" : "corporate";
        setTheme(next);
      });

      window.addEventListener("DOMContentLoaded", () => html.classList.remove("no-transitions"));
    })();
  </script>

  {% block extra_scripts %}{% endblock %}
</body>
</html>
