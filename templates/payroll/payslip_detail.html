<!-- templates/payroll/payslip_detail.html -->
{% extends "base.html" %}

{% block title %}Payroll Â· Payslip Details{% endblock %}

{% block page_actions %}
  {% if object.state == "draft" %}
  <a href="{% url 'payroll:payslip_edit' object.pk %}"
     class="btn btn-primary btn-sm">
    Edit
  </a>
  {% endif %}
{% endblock %}

{% block content %}
<div class="w-full px-6 py-8">
  <div class="mx-auto space-y-6">

    <!-- Header -->
    <div>
      <h1 class="text-2xl font-semibold">Payslip Details</h1>
      <p class="text-sm text-base-content/60">
        Payslip summary and calculated lines
      </p>
    </div>

    <!-- Summary -->
    <div class="card bg-base-100 border border-base-300">
      <div class="card-body grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">

        <div>
          <span class="opacity-60">Employee</span>
          <div class="font-medium">{{ object.employee }}</div>
        </div>

        <div>
          <span class="opacity-60">Company</span>
          <div class="font-medium">{{ object.company }}</div>
        </div>

        <div>
          <span class="opacity-60">Period</span>
          <div>{{ object.period.year }}-{{ object.period.month }}</div>
        </div>

        <div>
          <span class="opacity-60">Structure</span>
          <div>{{ object.struct }}</div>
        </div>

        <div>
          <span class="opacity-60">State</span>
          <div>
            {% if object.state == "draft" %}
              <span class="badge badge-warning badge-outline">Draft</span>
            {% elif object.state == "validated" %}
              <span class="badge badge-info badge-outline">Validated</span>
            {% elif object.state == "paid" %}
              <span class="badge badge-success badge-outline">Paid</span>
            {% else %}
              <span class="badge badge-ghost">Cancelled</span>
            {% endif %}
          </div>
        </div>

        <div>
          <span class="opacity-60">Net Wage</span>
          <div class="font-mono font-semibold">
            {{ object.net_wage }}
          </div>
        </div>

      </div>
    </div>

    <!-- Lines -->
    <div class="card bg-base-100 border border-base-300">
      <div class="card-body p-0">
        <div class="px-6 py-4 border-b border-base-300 font-semibold">
          Payslip Lines
        </div>

        <div class="overflow-x-auto">
          <table class="table table-zebra w-full">
            <thead>
              <tr class="bg-base-200">
                <th>Code</th>
                <th>Name</th>
                <th>Category</th>
                <th class="text-right">Total</th>
              </tr>
            </thead>
            <tbody>
              {% for line in object.lines.all %}
              <tr>
                <td class="font-mono">{{ line.code }}</td>
                <td>{{ line.name }}</td>
                <td>{{ line.category.code }}</td>
                <td class="text-right font-mono">{{ line.total }}</td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="4" class="text-center text-sm opacity-60">
                  No calculated lines
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="px-6 py-4 border-t border-base-300 flex gap-3">
          <a href="{% url 'payroll:payslip_list' %}"
             class="btn btn-ghost btn-sm">
            Back to list
          </a>
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
