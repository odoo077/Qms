{# templates/performance/kpi_metric_form.html #}
{% extends "base.html" %}
{% load static %}

{% block title %}
  {% if object %}Edit KPI Metric Â· {{ object.kpi.name }}{% else %}New KPI Metric{% endif %}
{% endblock %}

{% block page_title %}
  {% if object %}Edit KPI Metric{% else %}Add KPI Metric{% endif %}
{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto px-4 py-10">
  <div class="card bg-base-100 border border-base-300 shadow-xl">
    <div class="card-body space-y-6">

      <!-- Header -->
      <div class="flex items-start justify-between flex-wrap gap-2">
        <div>
          <h2 class="text-2xl font-bold">
            {% if object %}Edit KPI Metric{% else %}Add KPI Metric{% endif %}
          </h2>
          <p class="text-sm text-base-content/70 mt-1">
            Record performance data for <span class="font-medium text-primary">{{ object.kpi.name if object else kpi.name }}</span>
          </p>
        </div>
        <a href="{% url 'performance:kpi_detail_metrics' kpi.id %}" class="btn btn-ghost btn-sm">Back</a>
      </div>

      <form method="post" novalidate>
        {% csrf_token %}
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">

          <!-- Date -->
          <div class="form-control">
            <label class="label"><span class="label-text font-semibold">Date</span></label>
            {{ form.date }}
            {% if form.date.errors %}
              <p class="text-error text-xs mt-1">{{ form.date.errors.0 }}</p>
            {% endif %}
          </div>

          <!-- Period -->
          <div class="form-control">
            <label class="label"><span class="label-text font-semibold">Period</span></label>
            {{ form.period }}
            {% if form.period.errors %}
              <p class="text-error text-xs mt-1">{{ form.period.errors.0 }}</p>
            {% endif %}
          </div>

          <!-- Target Value -->
          <div class="form-control">
            <label class="label"><span class="label-text font-semibold">Target Value</span></label>
            {{ form.target_value }}
            {% if form.target_value.errors %}
              <p class="text-error text-xs mt-1">{{ form.target_value.errors.0 }}</p>
            {% endif %}
          </div>

          <!-- Actual Value -->
          <div class="form-control">
            <label class="label"><span class="label-text font-semibold">Actual Value</span></label>
            {{ form.actual_value }}
            {% if form.actual_value.errors %}
              <p class="text-error text-xs mt-1">{{ form.actual_value.errors.0 }}</p>
            {% endif %}
          </div>

          <!-- Progress -->
          <div class="form-control sm:col-span-2">
            <label class="label"><span class="label-text font-semibold">Progress (%)</span></label>
            {{ form.progress }}
            {% if form.progress.errors %}
              <p class="text-error text-xs mt-1">{{ form.progress.errors.0 }}</p>
            {% endif %}
          </div>

          <!-- Note -->
          <div class="form-control sm:col-span-2">
            <label class="label"><span class="label-text font-semibold">Note</span></label>
            {{ form.note }}
            {% if form.note.errors %}
              <p class="text-error text-xs mt-1">{{ form.note.errors.0 }}</p>
            {% endif %}
          </div>

        </div>

        <!-- Actions -->
        <div class="flex justify-end gap-2 mt-8">
          <a href="{% url 'performance:kpi_detail_metrics' kpi.id %}" class="btn btn-ghost">Cancel</a>
          <button type="submit" class="btn btn-primary">
            {% if object %}Save Changes{% else %}Add Metric{% endif %}
          </button>
        </div>
      </form>

    </div>
  </div>
</div>
{% endblock %}
