{% extends "base.html" %}

{% block title %}Evaluation Type{% endblock %}
{% block page_title %}Performance{% endblock %}
{% block header_title %}Evaluation Type{% endblock %}
{% block header_subtitle %}
  {% if object %}
    Edit evaluation type configuration.
  {% else %}
    Create a new evaluation type.
  {% endif %}
{% endblock %}

{% block page_actions %}
  <a href="{% url 'performance:evaluation_type_list' %}" class="btn btn-sm">
    Back
  </a>

  {% if object and perms.performance.delete_evaluationtype %}
    <a href="{% url 'performance:evaluation_type_delete' object.id %}"
       class="btn btn-error btn-sm">
      Delete
    </a>
  {% endif %}
{% endblock %}

{% block content %}
<div class="card bg-base-100 shadow">
  <div class="card-body space-y-6">

    {% if form.non_field_errors %}
      <div class="alert alert-error text-sm">
        <ul class="list-disc list-inside">
          {% for error in form.non_field_errors %}
            <li>{{ error }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <form method="post" novalidate>
      {% csrf_token %}

      <div class="space-y-4">
        <h2 class="text-sm font-semibold tracking-wide uppercase opacity-70">
          Basic Information
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          {% if form.company %}
          <div class="form-control">
            <label class="label">
              <span class="label-text">Company</span>
            </label>
            {{ form.company }}
            {% for error in form.company.errors %}
              <p class="text-error text-xs mt-1">{{ error }}</p>
            {% endfor %}
          </div>
          {% endif %}

          {% if form.name %}
          <div class="form-control">
            <label class="label">
              <span class="label-text">Name</span>
            </label>
            {{ form.name }}
            {% for error in form.name.errors %}
              <p class="text-error text-xs mt-1">{{ error }}</p>
            {% endfor %}
          </div>
          {% endif %}

          {% if form.code %}
          <div class="form-control">
            <label class="label">
              <span class="label-text">Code</span>
            </label>
            {{ form.code }}
            <label class="label">
              <span class="label-text-alt text-xs opacity-70">
                Optional internal code used in integrations or reports.
              </span>
            </label>
            {% for error in form.code.errors %}
              <p class="text-error text-xs mt-1">{{ error }}</p>
            {% endfor %}
          </div>
          {% endif %}

          {% if form.sequence %}
          <div class="form-control">
            <label class="label">
              <span class="label-text">Sequence</span>
            </label>
            {{ form.sequence }}
            <label class="label">
              <span class="label-text-alt text-xs opacity-70">
                Controls ordering in dropdowns and lists.
              </span>
            </label>
            {% for error in form.sequence.errors %}
              <p class="text-error text-xs mt-1">{{ error }}</p>
            {% endfor %}
          </div>
          {% endif %}

          {% if form.active %}
          <div class="form-control">
            <label class="label cursor-pointer justify-start gap-3">
              {{ form.active }}
              <span class="label-text">Active</span>
            </label>
            {% for error in form.active.errors %}
              <p class="text-error text-xs mt-1">{{ error }}</p>
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </div>

      <div class="space-y-4 mt-6">
        <h2 class="text-sm font-semibold tracking-wide uppercase opacity-70">
          Description
        </h2>

        {% if form.description %}
        <div class="form-control">
          {{ form.description }}
          {% for error in form.description.errors %}
            <p class="text-error text-xs mt-1">{{ error }}</p>
          {% endfor %}
        </div>
        {% else %}
        <p class="text-xs opacity-70">
          You can use a description field in the model to document usage and rules.
        </p>
        {% endif %}
      </div>

      {# أي حقول إضافية مستقبلية #}
      {% for field in form %}
        {% if field.name not in "company name code sequence active description" %}
        <div class="form-control mt-4">
          <label class="label">
            <span class="label-text">{{ field.label }}</span>
          </label>
          {{ field }}
          {% if field.help_text %}
            <label class="label">
              <span class="label-text-alt text-xs opacity-70">{{ field.help_text }}</span>
            </label>
          {% endif %}
          {% for error in field.errors %}
            <p class="text-error text-xs mt-1">{{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}
      {% endfor %}

      <div class="mt-8 flex items-center justify-between">
        <p class="text-xs opacity-70">
          Changes will affect all future evaluations using this type.
        </p>
        <button type="submit" class="btn btn-primary">
          {% if object %}Save Changes{% else %}Create Evaluation Type{% endif %}
        </button>
      </div>
    </form>

  </div>
</div>
{% endblock %}
